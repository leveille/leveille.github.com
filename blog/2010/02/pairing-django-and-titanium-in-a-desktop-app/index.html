
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Pairing Django and Titanium in a Desktop App - Jason Leveille</title>
  <meta name="author" content="Jason Leveille">

  
  <meta name="description" content="Over the past four months I have been doing a lot of work in Python and Django. Naturally, while recently playing around with Appcelerator Titanium &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jasonleveille.com/blog/2010/02/pairing-django-and-titanium-in-a-desktop-app">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Jason Leveille" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
    
  
  
  <!-- Twitter Card - http://davidwalsh.name/twitter-cards -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@jleveille">
  <meta name="twitter:creator" content="@jleveille">

  <!-- Facebook OG Tags -->
  <meta property="fb:admins" content="1753588182"/>
  <meta property="fb:app_id" content="219821018045917"/>
  <meta property="og:title" content="Pairing Django and Titanium in a Desktop App"/>
  <meta property="og:type" content="blog"/>
  <meta property="og:url" content="http://jasonleveille.com/blog/2010/02/pairing-django-and-titanium-in-a-desktop-app"/>
  <meta property="og:image" content="http://jasonleveille.com/images/leveille-headshot.png"/>
  <meta property="og:description" content="Over the past four months I have been doing a lot of work in Python and Django. Naturally, while recently playing around with Appcelerator Titanium &hellip;"/>
  <meta property="og:site_name" content="Jason Leveille"/>

  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
  <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37280745-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>
<hgroup>
  <h1><a href="/">Jason Leveille</a></h1>
  
    <h2>Web developer, loving life in Southern Maine</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:jasonleveille.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/portfolio/">Portfolio</a></li>
  <li><a href="/projects/">Projects</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Pairing Django and Titanium in a Desktop App</h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-17T21:07:00-05:00" pubdate data-updated="true">Feb 17<span>th</span>, 2010</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Over the past four months I have been doing a lot of work in Python and Django. Naturally, while recently playing around with <a href="http://www.appcelerator.com/products/titanium-desktop-application-development/">Appcelerator Titanium Desktop</a> (which seems to have good Python support), I wanted to see how Django and Titanium would pair.</p>

<!--more-->


<h2>Assumptions</h2>

<ol>
<li><a href="http://www.appcelerator.com/products/download/">Titanium installed</a></li>
<li><a href="http://docs.djangoproject.com/en/dev/topics/install/">Django installed</a></li>
</ol>


<h2>What Worked</h2>

<p>Over the course of a few hours, I was able to accomplish the following:</p>

<ul>
<li>Django Template integration</li>
<li>Django ORM interaction</li>
<li>Titanium Database communication with the Django DB (SQLite) defined in settings.py</li>
</ul>


<h2>Links</h2>

<ul>
<li><a href="/assets/leveille-django-titanium-7da2c38.tar.gz">Source Files</a></li>
</ul>


<h2>Directory Layout</h2>

<p><img src="https://www.evernote.com/shard/s33/sh/06d56a74-d35e-419e-840f-13cc9ab3dc22/9e3f959c495e5f348d463c6882dd7f75/res/8d23c11d-590c-404f-a1e7-d5b3dd480110.jpg?resizeSmall&width=832"></p>

<h2>Creating the Project</h2>

<p>When a Titanium Desktop application (with Python support) is running, the Resources directory for the application is placed in the system Python path. Therefore, my first step was to place the main django directory in Resources. From there, I navigated to Resources and executed the startproject command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ django-admin.py startproject test_project</span></code></pre></td></tr></table></div></figure>


<p>Next, I updated settings.py with information about my test database:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">os</span>
</span><span class='line'><span class="n">DATABASES</span> <span class="o">=</span><span class="p">{</span>
</span><span class='line'>    <span class="s">&#39;default&#39;</span><span class="p">:{</span>
</span><span class='line'>        <span class="s">&#39;ENGINE&#39;</span><span class="p">:</span><span class="s">&#39;django.db.backends.sqlite3&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;NAME&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)),</span><span class="s">&#39;test_project.db&#39;</span><span class="p">),</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>I made sure to include the full path to my test_project.db database, knowing that I would eventually need to refer to this path for Titanium Database support. Finally, I executed my syncdb command from within my test_project directory:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="err">$</span> <span class="o">./</span><span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">syncdb</span>
</span></code></pre></td></tr></table></div></figure>


<p>When prompted, I added a superuser account for myself.</p>

<h2>Django Template Integration</h2>

<p>Template integration was pretty smooth. What follows is a scaled down version of my index.html resource, and its associated files:</p>

<p>Resources >> <strong>index.html</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">//Yes,this is all I have inmy main index.html resource</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/python&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="nx">from</span> <span class="nx">test_project</span><span class="p">.</span><span class="nx">contrib</span><span class="p">.</span><span class="nx">template</span> <span class="kr">import</span> <span class="nx">index</span>
</span><span class='line'>    <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">index</span><span class="p">())</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Resources >> test_project >> contrib >> <strong>template.py</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span><span class='line'>    <span class="n">kwargs</span> <span class="o">=</span><span class="p">{</span><span class="s">&#39;foo&#39;</span><span class="p">:</span><span class="s">&#39;bar&#39;</span><span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">_render_template</span><span class="p">(</span><span class="s">&#39;index&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">_render_template</span><span class="p">(</span><span class="n">template_name</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span class='line'>    <span class="kn">from</span> <span class="nn">django.templateimport</span> <span class="nn">loader</span><span class="p">,</span><span class="n">Context</span>
</span><span class='line'>    <span class="n">t</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">.html&#39;</span><span class="o">%</span> <span class="n">template_name</span><span class="p">)</span>
</span><span class='line'>    <span class="n">c</span> <span class="o">=</span><span class="n">Context</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Resources >> test_project >> templates >> <strong>base.html</strong>, <strong>index.html</strong></p>

<div><script src='https://gist.github.com/4440297.js'></script>
<noscript><pre><code>{% block py_imports %}{% endblock %}
&lt;!DOCTYPE html&gt;
&lt;html dir=&quot;ltr&quot; lang=&quot;en-US&quot;&gt;
    &lt;head&gt;
        &lt;title&gt;{% block title %}{% endblock %}|TitaniumTesting&lt;/title&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;jquery-1.3.2.js&quot;&gt;&lt;/script&gt;
        {% block js %}{% endblock %}
    &lt;/head&gt;
    &lt;body&gt;
        {% block content %}{% endblock %}
    &lt;/body&gt;
&lt;/html&gt;</code></pre></noscript></div>




<div><script src='https://gist.github.com/4440303.js'></script>
<noscript><pre><code># index.html
{%extends&quot;base.html&quot;%}
{% block title %}TemplateCommunication{{ block.super}}{% endblock %}
{% block content %}
    &lt;strong&gt;Foo&lt;/strong&gt;:{{ foo }}&lt;!--Prints bar --&gt;
{% endblock %}</code></pre></noscript></div>


<h2>Database Communication</h2>

<p>Database communication also went fairly smooth (though I did get tripped up trying to find a method to use an existing SQLite db for Titanium &#8230; ultimately the following worked for me:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">Titanium</span><span class="o">.</span><span class="n">Database</span><span class="o">.</span><span class="n">openFile</span><span class="p">(</span><span class="s">&#39;/path/to/db&#39;</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>What follows are the code snippets which represent successful communication with the DB via Django, and via the Titanium Database API:</p>

<p>Resources >> test_project >> contrib >> <strong>db.py</strong>, <strong>user.py</strong></p>

<div><script src='https://gist.github.com/4440318.js'></script>
<noscript><pre><code># db.py
def py_get_db():
    from test_project import settings
    return settings.DATABASES['default']['NAME']
</code></pre></noscript></div>




<div><script src='https://gist.github.com/4440319.js'></script>
<noscript><pre><code># user.py
def py_update_name(username, first_name, last_name):
    from django.contrib.auth.models importUser
    user =User.objects.get(username=username)
    user.first_name = first_name
    user.last_name = last_name
    user.save()

def py_get_full_name(username):
    from django.contrib.auth.models importUser
    user =User.objects.get(username=username)
    return user.get_full_name()</code></pre></noscript></div>


<p>Resources >> test_project >> templates >> <strong>index.html</strong> (full version)</p>

<div><script src='https://gist.github.com/4440328.js'></script>
<noscript><pre><code>{%extends&quot;base.html&quot;%}

{% block title %}DatabaseCommunication{{ block.super}}{% endblock %}

{% block py_imports %}
&lt;script type=&quot;text/python&quot;&gt;             
from test_project.contrib.user import py_update_name, py_get_full_name
from test_project.contrib.db import py_get_db
&lt;/script&gt;
{% endblock %}

{% block js %}
    &lt;script&gt;
        var username = 'leveille';
        var first_name = 'Jason'
        var last_name = 'Leveille'
        
        /**
         *TellDjango to update user first/last name
         */
        py_update_name(username, first_name, last_name);
        
        $(document).ready(function(){
            /**
             *UseDjango to query the auth database
             *andreturn the user fullname
             */
            var $test_1 = $('#test_1');
            $('button', $test_1).bind('click', function(){
               $('.result', $test_1).text(py_get_full_name(username)); 
            });
            
            var $test_2 = $('#test_2');
            $('button', $test_2).bind('click', function(){
                var val = 'Empty result set';
                try {
                    var db = Titanium.Database.openFile(py_get_db());
                    var rs = db.execute(
                        &quot;SELECT first_name, last_name FROM auth_user &quot; 
                        + &quot;WHERE username = '&quot; 
                        + username 
                        + &quot;'&quot;
                    );
                    if(rs.isValidRow()){
                        val = rs.field(0) + ' ' + rs.field(1);
                    }
                } catch (err) {
                    val = err;
                } finally {
                    rs.close();
                    db.close();
                    $('.result', $test_2).text(val);
                }
            });
        });            
    &lt;/script&gt;
{% endblock %}

{% block content %}
    &lt;div id=&quot;test_1&quot;&gt;
        &lt;h1&gt;Test1&lt;/h1&gt;
        &lt;p&gt;
            &lt;button&gt;Django Query for my Full Name&lt;/button&gt;
        &lt;/p&gt;
        &lt;p&gt;
            &lt;strong&gt;Result&lt;/strong&gt;: 
        &lt;/p&gt;
    &lt;/div&gt;
    &lt;div id=&quot;test_2&quot;&gt;
        &lt;h1&gt;Test2&lt;/h1&gt;
        &lt;p&gt;
            &lt;button&gt;Titanium Query for my Full Name&lt;/button&gt;
        &lt;/p&gt;
        &lt;p&gt;
            &lt;strong&gt;Result&lt;/strong&gt;: 
        &lt;/p&gt;
    &lt;/div&gt;
    &lt;div id=&quot;test_3&quot;&gt;
        &lt;h1&gt;Test3&lt;/h1&gt;
        &lt;p&gt;
            Passing Template Variables
        &lt;/p&gt;
        &lt;p&gt;
            &lt;strong&gt;Foo&lt;/strong&gt;: {{ foo }}
        &lt;/p&gt;
    &lt;/div&gt;
{% endblock %}</code></pre></noscript></div>


<h2>The Result</h2>

<p><img src="https://www.evernote.com/shard/s33/sh/06d56a74-d35e-419e-840f-13cc9ab3dc22/9e3f959c495e5f348d463c6882dd7f75/res/bba35d6b-fa73-45f5-873b-e278c340cda5.jpg?resizeSmall&width=832"></p>

<p>If you have experience playing around with these two playfellows, feel free to share them here.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jason Leveille</span></span>

      








  


<time datetime="2010-02-17T21:07:00-05:00" pubdate data-updated="true">Feb 17<span>th</span>, 2010</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/django/'>Django</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://jasonleveille.com/blog/2010/02/pairing-django-and-titanium-in-a-desktop-app/" data-via="jleveille" data-counturl="http://jasonleveille.com/blog/2010/02/pairing-django-and-titanium-in-a-desktop-app/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2009/02/cakephp-vs-django-vs-rails-vs-who-cares-make-a-decision/" title="Previous Post: CakePHP vs Django vs Rails vs Who Cares - Make a Decision">&laquo; CakePHP vs Django vs Rails vs Who Cares - Make a Decision</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/01/2012-recap-2013-goals/" title="Next Post: 2012 Recap, 2013 Goals">2012 Recap, 2013 Goals &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p><img class="left" src="/images/leveille-headshot.png" width="90" height="90">Web developer for the <a href="http://nationalpriorities.org">National Priorities Project</a>.  Living with 3 beautiful ladies and living life in Soutern Maine.</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/03/the-10-commandments-of-logging/">The 10 Commandments of Logging</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/debian-ubuntu-adding-a-startup-script/">Debian & Ubuntu: Adding a StartUp Script</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/linux-extending-logical-volume/">Linux: Extending a Logical Volume</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/django-twittercard-released/">Django TwitterCard Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/giving-your-images-an-extra-squeeze/">Giving Your Images an Extra Squeeze</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("jleveille", 1, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/jleveille" class="twitter-follow-button" data-show-count="false">Follow @jleveille</a>
  
</section>



<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/jason@leve.us?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Jason Leveille -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
